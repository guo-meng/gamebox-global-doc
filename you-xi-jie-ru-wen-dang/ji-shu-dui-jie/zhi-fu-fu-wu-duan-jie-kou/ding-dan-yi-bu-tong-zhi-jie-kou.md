# 订单异步通知接口

## 接口说明

支付完成后，我司支付服务器会把交易结果通知到下单时传递的url：notifyUrl，建议商户根据异步通知结果修改订单交易状态。

注意：因为网络或者其它原因，可能会有重复通知的情况，CP需要做好去重处理，避免重复发货。

## 访问地址

接口地址：支付结果通知地址在下单接口中通过参数notifyUrl传递。

请求方式：POST请求

## 请求参数

| **参数** | **含义** | **长度** | **类型** | **是否为空** | **备注** |
| :--- | :--- | :--- | :--- | :--- | :--- |
| errorCode | 错误码,参考文末 | 10 | **整数** | **非空** |  |
| errorMsg | 错误描述 | 20 | **字符串** | **非空** | 结果描述 |
| gameId | 游戏Id | 10 | **整数** | **非空** | 游戏Id |
| cpOrderId | 商户自定义订单号 | 64 | **字符串** | **非空** | 商户自定义，最长 64 位字母、数字和下划线组成,**商户订单号必须唯一** |
| orderAmount | 交易金额 | 100 | **整数** | **非空** | 交易金额，单位（**分**） |
| orderId | 我司订单号 | 64 | **字符串** | **非空** | 我司订单号，唯一性 |
| tradeResult | 支付结果 | 10 | **整数** | **非空** | 支付结果，0：未知；1：成功；2：失败 |
| payTime | 交易时间 | 30 | **字符串** | **非空** | 交易时间。格式：yyyyMMddHHmmss |
| userId | 我司生成的userId | 20 | **长整数** | **非空** | 我司生成的userId，唯一性 |
| extension | 透传扩展字段 | 20 | **字符串** | **可空** | 透传扩展字段 |
| sign | 签名字符串 | 30 | **字符串** | **非空** | 对关键信息签名后得到的字符串1，用于商户验签签名规则请参考签名生成规则 |

## 返回结果

返回格式：字符串

说明：

我司支付服务器端通过notifyUrl通知开发者服务器，开发者服务器处理完相关的业务逻辑后，需要以字符串的形式反馈处理结果，内容如下：

* success：处理成功，我司系统收到此结果后不再进行后续通知：
* fail：处理不成功，我司系统收到此结果或者没有收到任何结果，系统通过补单机制再次通知；

## 补单机制：

该异步通知最多会发送5次，直到我司支付服务器收到开发者服务器返回success为止。如果5次我司服务器都没收到，则不再发送通知，商户后续需要请求订单查询接口来修正订单支付结果

## 重要

我司异步通知开发者服务器的IP为固定IP，开发者需要将该IP做白名单处理，只有该IP发送的通知为合法通知，IP地址为：**47.100.63.200**

